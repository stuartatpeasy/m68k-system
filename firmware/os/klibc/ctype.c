/*
	ctype.c - same deal as in libc

	Part of the as-yet-unnamed MC68010 operating system


	(c) Stuart Wallace, June 2015
*/

#include "ctype.h"

/*
	This is a 384-byte lookup table used by the "int is<x>(int c)" functions, e.g. isupper().  Each entry consists of
	zero or more flags bitwise-ORed together.  All the is<x>() functions are then #define'd as calls to _ctypeisname(),
	which performs the appropriate lookup.
*/
ku16 _g_typetable[384] =
{
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0200, 0x0320, 0x0220, 0x0220, 0x0220, 0x0220, 0x0200, 0x0200,
	0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200,
	0x0160, 0x04c0, 0x04c0, 0x04c0, 0x04c0, 0x04c0, 0x04c0, 0x04c0,
	0x04c0, 0x04c0, 0x04c0, 0x04c0, 0x04c0, 0x04c0, 0x04c0, 0x04c0,
	0x08d8, 0x08d8, 0x08d8, 0x08d8, 0x08d8, 0x08d8, 0x08d8, 0x08d8,
	0x08d8, 0x08d8, 0x04c0, 0x04c0, 0x04c0, 0x04c0, 0x04c0, 0x04c0,
	0x04c0, 0x08d5, 0x08d5, 0x08d5, 0x08d5, 0x08d5, 0x08d5, 0x08c5,
	0x08c5, 0x08c5, 0x08c5, 0x08c5, 0x08c5, 0x08c5, 0x08c5, 0x08c5,
	0x08c5, 0x08c5, 0x08c5, 0x08c5, 0x08c5, 0x08c5, 0x08c5, 0x08c5,
	0x08c5, 0x08c5, 0x08c5, 0x04c0, 0x04c0, 0x04c0, 0x04c0, 0x04c0,
	0x04c0, 0x08d6, 0x08d6, 0x08d6, 0x08d6, 0x08d6, 0x08d6, 0x08c6,
	0x08c6, 0x08c6, 0x08c6, 0x08c6, 0x08c6, 0x08c6, 0x08c6, 0x08c6,
	0x08c6, 0x08c6, 0x08c6, 0x08c6, 0x08c6, 0x08c6, 0x08c6, 0x08c6,
	0x08c6, 0x08c6, 0x08c6, 0x04c0, 0x04c0, 0x04c0, 0x04c0, 0x0200,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
	0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000
};

ku16 * const _g_typetable_base = _g_typetable + 128;


s32 _ctypeisname(int c, ku16 type)
{
	return _g_typetable_base[c & 0xff] & type;
}


s32 tolower(s32 c)
{
    return ((c >= 'A') && (c <= 'Z')) ? c + ('a' - 'A') : c;
}


s32 toupper(s32 c)
{
    return ((c >= 'a') && (c <= 'z')) ? c - ('a' - 'A') : c;
}
